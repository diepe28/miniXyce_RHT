# To compile execute the following commands:

    cd cmake-build-debug/
    cmake ..
    make

# Thats it!

$ Examples of execution:

# to see how it scales with HT
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"
mpirun -np 2 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"
mpirun -np 4 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"

# to test replicated versions
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 2
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 1
mpirun -np 2 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 4 0 1 2 3
mpirun -np 2 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 4 0 2 1 3

# the args are the following:
    -c,                         a param of miniXyce app, it indicates that is going to use a test file
    "$PWD"/tests/cirHuge.net,   the path to the test file where the circuit is described.
                                The "$PWD" executes the pwd command. There are other test files in the
                                tests/ folder.
    "$PWD",                     is the current directoy, which is needed to locate the files
                                default_params.txt and last_used_params.txt which are necessary.
    numRuns,                    number of executions, used to calculate the mean exec time
    numThreads,                 the number of threads that will be needed. Should be mpi -np ranks x 2
    threadList,                 the number of logical cores where the threads will be pinned.

# So for example:
mpirun -np 2 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 4 0 2 1 3

Excecutes 2 ranks of mpi, 5 times, the test file is cirHuge.net, there will be 4 threads (consumer, producer in
each rank). Producer1 will be pinned to core 0, Consumer1 will be pinned to core 2, Producer2 will be
pinned to core 1 and Consumer2 will be pinned to core 3.

# Depending on the order of cores, the replicas will be pinned to hyper-threads or not.

# Next are commands ready to be executed on multiple grid5K machines. They have the correct order of threads
so that there are HT and no HT versions

// MyLaptop 0,2 and 1,3 are hyperThreads
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" &&
mpirun -np 2 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" &&
mpirun -np 4 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 2 &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 1 &&
mpirun -np 2 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 4 0 1 2 3 &&
mpirun -np 2 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 4 0 2 1 3

// Nantes - Ecotype 0,20 2,22 4,24... are hyperThreads
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"         &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 32 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 2   &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 20  &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 2 4 6 8 10 12 14 1 3 5 7 9 11 13 15 20 22 24 26 28 30 32 34 21 23 25 27 29 31 33 35 &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 20 2 22 4 24 6 26 8 28 10 30 12 32 14 34 1 21 3 23 5 25 7 27 9 29 11 31 13 33 15 35

// Nantes - Econome 0,16 1,17 2,18... are hyperThreads
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"         &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 32 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 1   &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 16  &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 16 1 17 2 18 3 19 4 20 5 21 6 22 7 23 8 24 9 25 10 26 11 27 12 28 13 29 14 30 15 31

// Nancy - Graphite 0,16 2,18 4,20... are hyperThreads
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"         &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 32 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 2   &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 16  &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 2 4 6 8 10 12 14 1 3 5 7 9 11 13 15 16 18 20 22 24 26 28 30 17 19 21 23 25 27 29 31 &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 16 2 18 4 20 6 22 8 24 10 26 12 28 14 30 1 17 3 19 5 21 7 23 9 25 11 27 13 29 15 31

// Lyon - Nova 0,16 2,18 4,20... are hyperThreads
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"         &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 32 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD"        &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 2   &&
mpirun -np 1 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 2 0 16   &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 2 4 6 8 10 12 14 1 3 5 7 9 11 13 15 16 18 20 22 24 26 28 30 17 19 21 23 25 27 29 31 &&
mpirun -np 16 miniXyceRHT -c "$PWD"/tests/cirHuge.net "$PWD" 5 32 0 16 2 18 4 20 6 22 8 24 10 26 12 28 14 30 1 17 3 19 5 21 7 23 9 25 11 27 13 29 15 31
